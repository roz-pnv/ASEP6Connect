{% extends "staff_panel/panel.html" %}
{% load static %}

{% block page_title %}💼 Wallet Overview{% endblock %}

{% block action_buttons %}
<div class="card-header-flex">
  <div class="action-buttons">
    <button id="toggleFilter" class="btn btn-purple">🔍 Filter</button>
  </div>
</div>
{% endblock %}

{% block main_class %}with-sidebar{% endblock %}

{% block main_content %}
<div class="wallet-dashboard">

  <!-- Wallets Table -->
  <div class="wallet-card transactions-card">
    <table class="transaction-table">
      <thead>
        <tr>
          <th>#</th>
          <th>User</th>
          <th>Balance</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for wallet in wallets %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ wallet.user.get_full_name }} ({{ wallet.user.username }})</td>
            <td class="balance-amount">{{ wallet.balance }} تومان</td>
            <td>
              <a href="{% url 'admin_transaction_list' %}?user_query={{ wallet.user.username }}" class="btn btn-sm btn-purple">View</a>
              <a href="#" class="btn btn-sm btn-warning">Edit</a>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="4" class="transaction-empty">No wallets found.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}

{% block right_sidebar %}
<aside class="sidebar-right">
  <div class="filter-header">
    <h5>🔍 Filter Wallets</h5>
    <button id="closeFilter" class="btn btn-sm btn-outline-secondary">✖</button>
  </div>
  <form method="get" class="filter-form px-3">
    <div class="form-group mb-3">
	  {{ filter_form.user_query.label_tag }}
	  {{ filter_form.user_query }}
	</div>
    <div class="form-group mb-3">
      {{ filter_form.min_balance.label_tag }}
      {{ filter_form.min_balance }}
    </div>
    <div class="form-group mb-3">
      {{ filter_form.max_balance.label_tag }}
      {{ filter_form.max_balance }}
    </div>
    <div class="form-group mb-3">
      {{ filter_form.created_after.label_tag }}
      {{ filter_form.created_after }}
    </div>
    <div class="form-group mb-3">
      {{ filter_form.created_before.label_tag }}
      {{ filter_form.created_before }}
    </div>
    <button type="submit" class="btn btn-purple w-100">Apply Filter</button>
    <a href="{% url 'admin_wallet_list' %}" class="btn btn-outline-secondary">Reset</a>
  </form>
</aside>
{% endblock %}
